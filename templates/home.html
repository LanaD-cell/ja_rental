<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ _('Calli the Camper') }}</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Datepicker CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"/>

    <!-- jQuery (required) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Datepicker JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

    <!-- Favicon -->
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">

    <!-- Your custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

</head>
<body>
<div class="container mt-4">

  <!-- Language Switcher -->
  <form method="get" action="/">
    <div class="mb-3">
      <label for="lang">{{ _('Select Language') }}</label>
      <select name="lang" id="lang" class="form-select" onchange="this.form.submit()">
        <option value="en" {% if request.args.get('lang') == 'en' %}selected{% endif %}>English</option>
        <option value="de" {% if request.args.get('lang') == 'de' %}selected{% endif %}>Deutsch</option>
      </select>
    </div>
  </form>

  <h1>{{ van.name }}</h1>
  <p>{{ van.description }}</p>
  <p><strong>${{ van.price_per_day }}</strong> {{ _('per day') }}</p>

  <label for="rental-date">{{ _('Select Rental Date:') }}</label>
  <input id="rental-date" class="form-control" />

  <script>
    $(function() {
      const bookedDates = {{ booked_dates|safe }};

      let disabledDates = [];
      bookedDates.forEach(range => {
        let current = new Date(range.start);
        let end = new Date(range.end);
        while (current <= end) {
          disabledDates.push(new Date(current).toISOString().split('T')[0]);
          current.setDate(current.getDate() + 1);
        }
      });

      $('#rental-date').datepicker({
        format: 'yyyy-mm-dd',
        startDate: new Date(),
        datesDisabled: disabledDates,
        autoclose: true,
        todayHighlight: true,
      });
    });
  </script>
</div>
</body>
</html>
